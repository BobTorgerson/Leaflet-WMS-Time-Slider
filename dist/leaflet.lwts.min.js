L.Control.SliderControl=L.Control.extend({options:{position:"topright",layers:null,maxValue:-1,minValue:-1,startTime:-1,endTime:-1,timeStep:3600,range:!1,dateDisplayFormat:"YYYY-MM-DDTHH:mm:ssZ",timezone:"UTC"},initialize:function(a){L.Util.setOptions(this,a),this._layer=null,this.multilayer=!1,this._begin_time=a.startTime.tz(this.options.timezone),this._final_time=a.endTime.tz(this.options.timezone),this.options.timeStep=1e3*this.options.timeStep,null==this.options.layers?(this._layer=this.options.layer,this.multilayer=!1):(this._layer=this.options.layers,this.multilayer=!0)},setPosition:function(a){var b=this._map;return b&&b.removeControl(this),this.options.position=a,b&&b.addControl(this),this.startSlider(),this},createSliderUI:function(){var a=L.DomUtil.create("div","ui-slider-container",this._container);return this._slider=$('<div class="ui-slider"><div class="ui-slider-handle"></div></div>'),$(a).append(this._slider),this._sliderTimestamp=$('<div class="ui-slider-timestamp"></div>'),$(a).append(this._sliderTimestamp),a},onAdd:function(a){this.options.map=a;var b=this.createSliderUI();return $(b).mousedown(function(){a.dragging.disable()}),$(document).mouseup(function(){a.dragging.enable()}),this._layer||console.log("Error: You must specify a layer via new SliderControl({layer: your_layer}); or like SliderControl({layers: [your_layer1, your_layer2]});"),b},onRemove:function(a){a.removeLayer(this._layer),$(this._slider).remove()},updateLayer:function(a){if(timestamp=moment.utc(a[0]).format()+"/"+moment.utc(a[1]).format(),1==this.multilayer)for(var b=0;b<this._layer.length;b++)this._layer[b].setParams({time:timestamp});else this._layer.setParams({time:timestamp})},updateTimestamp:function(a){$(this._sliderTimestamp).html(a[0].format(this.options.dateDisplayFormat)+" - "+a[1].format(this.options.dateDisplayFormat))},buildTimestamp:function(a,b){return this._timerange1=moment(this._begin_time).add(a*this.options.timeStep,"ms").tz(this.options.timezone),this._timerange2=moment(this._begin_time).add(b*this.options.timeStep,"ms").tz(this.options.timezone),[this._timerange1,this._timerange2]},startSlider:function(){var a=this,b=Math.round((a._final_time-a._begin_time)/a.options.timeStep);$(a._slider).slider({range:a.options.range,min:0,max:b,step:1,slide:function(b,c){a.updateTimestamp(a.options.range?a.buildTimestamp(c.values[0],c.values[1]):a.buildTimestamp(c.value,c.value+1))},stop:function(b,c){a.updateLayer(a.options.range?a.buildTimestamp(c.values[0],c.values[1]):a.buildTimestamp(c.value,c.value+1))}}),a.updateTimestamp(a.buildTimestamp(0,1)),a.updateLayer(a.buildTimestamp(0,1))}}),L.control.sliderControl=function(a){return new L.Control.SliderControl(a)};